import{b as p,u as I,a as h,j as t,r as v,m as N,F as C,D as P}from"./index-Clugc84n.js";import{i as y,j as k,k as w,F as E}from"./Menu-C9WT4zKC.js";import{f as F,h as D,i as V,j as z}from"./images-2pmZfYHy.js";function b(n){const{data:s,isLoading:r,isError:d}=p(y(n.comment.commentId)),{mutate:c,isPending:a}=k(),{mutate:m,isPending:j}=w(),{user:o}=I(),g=h();function l(e,i,u){if(e.preventDefault(),e.stopPropagation(),a||j)return;const f=s&&s.find(x=>x.commentId===n.comment.commentId&&o&&x.userId===o.userId);o&&f?m({voteId:f.voteId,value:u}):o?c({postId:i.postId,commentId:i.commentId,value:u}):g({to:"/login"})}return t.jsx("div",{children:d?t.jsx("div",{children:"Error fetching votes"}):r?t.jsx("div",{children:"Loading..."}):s?t.jsxs("div",{className:"flex w-fit rounded-full py-1 justify-center",children:[s.filter(e=>e.commentId===n.comment.commentId&&o&&e.userId===o.userId&&e.value===1).length>0?t.jsx("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),m({voteId:s.find(i=>i.commentId===n.comment.commentId&&o&&i.userId===o.userId&&i.value===1).voteId,value:0})},className:"pr-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(F,{size:20})}):t.jsx("div",{onClick:e=>{l(e,n.comment,1)},className:"pr-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(D,{size:20})}),t.jsx("div",{className:"",children:s.filter(e=>e.commentId===n.comment.commentId).reduce((e,i)=>e+i.value,0)}),s.filter(e=>e.commentId===n.comment.commentId&&o&&e.userId===o.userId&&e.value===-1).length>0?t.jsx("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),m({voteId:s.find(i=>i.commentId===n.comment.commentId&&o&&i.userId===o.userId&&i.value===-1).voteId,value:0})},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(V,{size:20})}):t.jsx("div",{onClick:e=>{l(e,n.comment,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(z,{size:20})})]}):t.jsx("div",{children:"An unexpected error has occured"})})}function L(n){const s=v.useRef(null),{user:r}=I(),{setEditCommentModePointer:d}=N();h();function c(a){s.current&&!s.current.contains(a.target)&&n.setShowMenu(!1)}return v.useEffect(()=>(document.addEventListener("click",c),()=>document.removeEventListener("click",c)),[]),t.jsxs("div",{ref:s,className:"absolute top-12 right-2 py-2 px-5 rounded bg-[#222222] shadow-[0_0_15px_rgba(0,0,0,0.7)] z-40",children:[r&&n.comment.userId===r.userId&&t.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[t.jsx(E,{size:20,className:"pt-1"}),t.jsx("div",{onClick:()=>{d(n.comment.commentId),n.setCommentContent(n.comment.content||""),n.setShowMenu(!1)},className:"ml-2",children:"Edit"})]}),t.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[t.jsx(C,{size:20,className:"pt-1"}),t.jsx("div",{className:"ml-2",children:"Save"})]}),r&&n.comment.userId===r.userId&&t.jsxs("div",{onClick:a=>{a.stopPropagation(),a.preventDefault(),n.setDeleteMode(!0),n.setShowMenu(!1)},className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[t.jsx(P,{size:20,className:"pt-1 "}),t.jsx("div",{className:"ml-2",children:"Delete"})]})]})}export{b as C,L as a};
