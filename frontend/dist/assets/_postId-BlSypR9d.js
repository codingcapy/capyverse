import{q as y,u as x,a as g,c,R as f,b as h,r as j,d as v,j as o}from"./index-CayKkkm5.js";import{u as C,V as w}from"./VotesComponent-Df0QrBus.js";function b(e){return{...e,createdAt:new Date(e.createdAt)}}async function E(e){const t=await c.api.v0.comments.$post({json:e});if(!t.ok){let s="There was an issue creating your comment :( We'll look into it ASAP!";try{const n=await t.json();n&&typeof n=="object"&&"message"in n&&(s=String(n.message))}catch(n){console.error("Failed to parse error response:",n)}throw new Error(s)}return await t.json()}const q=e=>{const t=x();return g({mutationFn:E,onSettled:()=>{t.invalidateQueries({queryKey:["comments"]})},onError:a=>{}})};async function S(){const e=await c.api.v0.comments.$get();if(!e.ok)throw new Error("Error getting comments");const{comments:t}=await e.json();return t.map(b)}const A=()=>y({queryKey:["comments"],queryFn:()=>S()});function R(){const e=f.useRouteContext(),{user:t}=h(),{data:a,isPending:s,error:n}=C(A()),[i,m]=j.useState(""),{mutate:u}=q(),l=v();function d(r){if(r.preventDefault(),!t)return l({to:"/login"});const p=t.userId;u({userId:p,postId:e.postId,content:i})}return o.jsxs("div",{className:"p-20 mx-auto w-full lg:w-[50%]",children:[o.jsxs("div",{className:"text-4xl font-bold",children:[" ",e.title]}),o.jsx("div",{className:"my-10",children:o.jsx("div",{children:e.content})}),o.jsx(w,{post:e}),o.jsx("form",{onSubmit:d,children:o.jsx("input",{type:"text",placeholder:"Add your reply",className:"px-5 py-2 my-5 rounded-full border border-[#5c5c5c] w-full hover:bg-[#383838] hover:border-[#818181] transition-all ease-in-out duration-300",value:i,onChange:r=>m(r.target.value),required:!0})}),n?o.jsx("div",{}):s?o.jsx("div",{}):a.map(r=>o.jsx("div",{children:r.content},r.commentId))]})}export{R as component};
