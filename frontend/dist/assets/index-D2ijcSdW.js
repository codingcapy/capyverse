import{r as l,c as N,u as b,j as e,L as w,g as y}from"./index-DRWk6ygY.js";import{d as I,F as E,V as P,M as C,u as v,P as k,g as L}from"./Menu-ToNNbxKr.js";function j(s){const[r,i]=l.useState(!1),[n,d]=l.useState(!1),{mutate:m}=N(),{user:a}=b();return e.jsxs("div",{className:"mx-auto w-full lg:w-[50%] 2xl:w-[750px] border-t border-[#636363]",children:[e.jsxs(w,{to:"/posts/$postId",params:{postId:s.post.postId.toString()},children:[e.jsxs("div",{className:"relative my-1 rounded p-5 hover:bg-[#333333] transition-all ease-in-out duration-300",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex text-[#bdbdbd] text-sm",children:[e.jsx("div",{className:"font-bold",children:s.post.username}),e.jsx("div",{className:"px-1",children:"•"}),e.jsx("div",{children:I(s.post.createdAt)})]}),e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),i(!r)},className:"absolute top-1 right-1 p-3 rounded-full hover:bg-[#575757] transition-all ease-in-out duration-300",children:e.jsx(E,{})})]}),e.jsx("div",{className:"text-2xl font-bold",children:s.post.title}),e.jsx("div",{className:"my-2",children:s.post.content}),e.jsx(P,{post:s.post}),r&&e.jsx(C,{post:s.post,setDeleteMode:d,setShowMenu:i})]}),a&&s.post.userId===a.userId&&n&&e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-[#222222] p-6 rounded shadow-lg w-[90%] max-w-md text-center z-100",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Delete Post?"}),e.jsx("div",{className:"my-5",children:"Once you delete this post, it can’t be restored."}),e.jsxs("div",{className:"my-5 flex justify-end",children:[e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),m({postId:s.post.postId}),d(!1)},className:"p-2 mr-1 bg-red-500 rounded text-white bold secondary-font font-bold cursor-pointer",children:"DELETE"}),e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),d(!1)},className:"p-2 ml-1 bg-[#5c5c5c] rounded bold secondary-font font-bold cursor-pointer",children:"CANCEL"})]})]})]},s.post.postId),a&&s.post.userId===a.userId&&n&&e.jsx("div",{className:"fixed inset-0 bg-black opacity-50 z-60"})]})}function A(){const{data:s,isLoading:r,isError:i}=v(y()),{data:n,isLoading:d,isError:m}=v(L()),[a,t]=l.useState(!1),[p,f]=l.useState("Popular"),c=l.useRef(null);function h(o){c.current&&!c.current.contains(o.target)&&t(!1)}return l.useEffect(()=>(document.addEventListener("click",h),()=>document.removeEventListener("click",h)),[]),e.jsx("div",{className:"flex-1 p-2",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"mx-auto w-full lg:w-[50%] pt-[70px] pb-5 ",children:e.jsxs("div",{ref:c,className:"relative mx-auto w-full 2xl:w-[750px] flex",children:[e.jsxs("div",{onClick:()=>t(!a),className:"flex cursor-pointer",children:[e.jsx("div",{className:"text-xs",children:p}),e.jsx("div",{className:"ml-2",children:e.jsx(k,{})})]}),a&&e.jsxs("div",{onClick:()=>{},className:"absolute top-5 left-0 bg-[#444444] px-5 py-2 z-50",children:[e.jsx("div",{onClick:()=>{f("Popular"),t(!1)},className:" py-1 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:"Popular"}),e.jsx("div",{onClick:()=>{f("New"),t(!1)},className:"py-1 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:"New"})]})]})}),i?e.jsx("div",{className:"mx-auto w-full lg:w-[50%]",children:"Error fetching posts"}):r?e.jsx("div",{className:"mx-auto w-full lg:w-[50%]",children:"Loading..."}):s?p==="Popular"?s.sort((o,u)=>{const g=n?.filter(x=>x.postId===o.postId).length||0;return(n?.filter(x=>x.postId===u.postId).length||0)-g}).map(o=>e.jsx(j,{post:o},o.postId)):s.sort((o,u)=>u.createdAt.getTime()-o.createdAt.getTime()).map(o=>e.jsx(j,{post:o},o.postId)):e.jsx("div",{children:"An unexpected error has occured"})]})})}export{A as component};
