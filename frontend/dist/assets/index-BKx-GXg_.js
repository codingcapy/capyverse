import{r,c as N,j as e,d as C}from"./index-vmVYUcq_.js";import{u as f}from"./images-Co7s8ucK.js";import{P as a}from"./PostThumbnail-SAGYwbvC.js";import{P as L,b as E}from"./Menu-DhELVRT9.js";import"./users-DkwWoM6q.js";function M(){const{data:n,isLoading:h,isError:v}=f(C()),{data:i,isLoading:w,isError:j}=f(E()),[u,o]=r.useState(!1),[x,m]=r.useState("Popular"),l=r.useRef(null),{searchContent:t}=N();function p(s){l.current&&!l.current.contains(s.target)&&o(!1)}return r.useEffect(()=>(document.addEventListener("click",p),()=>document.removeEventListener("click",p)),[]),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"mx-auto w-full md:w-[50%] pt-[70px] pb-5 ",children:e.jsxs("div",{ref:l,className:"relative mx-auto w-full 2xl:w-[750px] flex",children:[e.jsxs("div",{onClick:()=>o(!u),className:"flex cursor-pointer pl-4 md:pl-0 md:pt-1 hover:text-cyan-500 transition-all ease-in-out duration-300",children:[e.jsx("div",{className:"text-xs",children:x}),e.jsx("div",{className:"ml-2",children:e.jsx(L,{})})]}),u&&e.jsxs("div",{onClick:()=>{},className:"absolute top-6 left-0 bg-[#444444] px-5 py-2 z-50 shadow-[0_0_15px_rgba(0,0,0,0.7)]",children:[e.jsx("div",{onClick:()=>{m("Popular"),o(!1)},className:" py-1 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:"Popular"}),e.jsx("div",{onClick:()=>{m("New"),o(!1)},className:"py-1 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:"New"})]})]})}),v?e.jsx("div",{className:"mx-auto w-full lg:w-[50%]",children:"Error fetching posts"}):h?e.jsx("div",{className:"mx-auto w-full lg:w-[50%]",children:"Loading..."}):n?x==="Popular"?j?e.jsx("div",{className:"mx-auto w-full lg:w-[50%]",children:"Error fetching votes"}):w?e.jsx("div",{className:"mx-auto w-full lg:w-[50%]",children:"Loading..."}):i?n.sort((s,c)=>{const g=i.filter(d=>d.postId===s.postId).length||0;return(i.filter(d=>d.postId===c.postId).length||0)-g}).map(s=>t===""?e.jsx(a,{post:s},s.postId):s.title.toLowerCase().includes(t.toLowerCase())||s.content.toLowerCase().includes(t.toLowerCase())?e.jsx(a,{post:s},s.postId):""):e.jsx("div",{children:"An unexpected error has occured"}):n.sort((s,c)=>c.createdAt.getTime()-s.createdAt.getTime()).map(s=>t===""?e.jsx(a,{post:s},s.postId):s.title.toLowerCase().includes(t.toLowerCase())||s.content.toLowerCase().includes(t.toLowerCase())?e.jsx(a,{post:s},s.postId):""):e.jsx("div",{children:"No posts! Be the first to create one."})]})})}export{M as component};
