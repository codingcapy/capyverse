import{U as a,V as i,S as u,T as n,W as c}from"./index-Dg670gwu.js";async function y(e){const r=await n.api.v0.users.$post({json:e});if(!r.ok){let o="There was an issue creating your account :( We'll look into it ASAP!";try{const t=await r.json();t&&typeof t=="object"&&"message"in t&&(o=String(t.message))}catch(t){console.error("Failed to parse error response:",t)}throw new Error(o)}const s=await r.json();if(!s.user)throw new Error("Invalid response from server");return s.user}const d=e=>{const r=a();return i({mutationFn:y,onSettled:()=>{r.invalidateQueries({queryKey:["users"]})},onError:s=>{}})};async function p(e){const r=await n.api.v0.users[":userId"].$get({param:{userId:e}});if(!r.ok)throw new Error("Error getting user by id");const{userQuery:s}=await r.json();return s}const f=e=>u({queryKey:["user",e],queryFn:()=>p(e)});async function l(e){const r=await n.api.v0.users.user[":username"].$get({param:{username:e}});if(!r.ok)throw new Error("Error getting user by id");const{userQuery:s}=await r.json();return s}const m=e=>u({queryKey:["user",e],queryFn:()=>l(e)});async function w(e){const r=c(),s=await n.api.v0.users.update.profilepic.$post({json:e},r?{headers:{Authorization:`Bearer ${r}`}}:void 0);if(!s.ok)throw new Error("Error updating user.");const{newUser:o}=await s.json();return console.log(o),o}const q=()=>{const e=a();return i({mutationFn:w,onSettled:r=>{r&&(e.invalidateQueries({queryKey:["users",r.userId]}),e.invalidateQueries({queryKey:["users"]}))}})};export{q as a,m as b,f as g,d as u};
