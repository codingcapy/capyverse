import{G as V,H as b,J as ce,K as ue,u as Lt,a as Dt,b as Ke,j as c,M as nn,r as St,q as on,N as rn,c as sn,O as an,P as ln,F as cn,y as un}from"./index-DADqQpbt.js";import{f as fn,h as He,i as mn,j as Ae}from"./images-B2PBCai7.js";function bt(t){return{...t,createdAt:new Date(t.createdAt)}}async function pn(t){const n=await b.api.v0.comments.$post({json:t});if(!n.ok){let s="There was an issue creating your comment :( We'll look into it ASAP!";try{const a=await n.json();a&&typeof a=="object"&&"message"in a&&(s=String(a.message))}catch(a){console.error("Failed to parse error response:",a)}throw new Error(s)}return await n.json()}const Jn=t=>{const n=ce();return ue({mutationFn:pn,onSettled:()=>{n.invalidateQueries({queryKey:["comments"]})},onError:o=>{}})};async function dn(t){const n=await b.api.v0.comments[":postId"].$get({param:{postId:t.toString()}});if(!n.ok)throw new Error("Error getting comments by id");const{comments:o}=await n.json();return o.map(bt)}const eo=t=>V({queryKey:["comments",t],queryFn:()=>dn(t)});async function gn(t){const n=await b.api.v0.comments.comment.delete.$post({json:t});if(!n.ok){let s="There was an issue deleting your post :( We'll look into it ASAP!";throw console.log(t),new Error(s)}return await n.json()}const to=t=>{const n=ce();return ue({mutationFn:gn,onSettled:(o,s)=>{if(!o)return console.log("No data, returning");n.invalidateQueries({queryKey:["comments",o.commentResult.postId]}),n.invalidateQueries({queryKey:["posts"]})},onError:o=>{}})};async function hn(t){const n=await b.api.v0.comments.comment.update.$post({json:t});if(!n.ok){let s="There was an issue updating your post :( We'll look into it ASAP!";throw console.log(t),new Error(s)}return await n.json()}const no=t=>{const n=ce();return ue({mutationFn:hn,onSettled:(o,s)=>{if(!o)return console.log("No data, returning");n.invalidateQueries({queryKey:["comments",o.commentResult.postId]}),n.invalidateQueries({queryKey:["posts"]})},onError:o=>{}})};async function En(t){const n=await b.api.v0.comments.user[":userId"].$get({param:{userId:t.toString()}});if(!n.ok)throw new Error("Error getting comments by user id");const{comments:o}=await n.json();return o.map(bt)}const oo=t=>V({queryKey:["comments",t],queryFn:()=>En(t)});async function Tn(t){const n=await b.api.v0.comments.post.count[":postId"].$get({param:{postId:t.toString()}});if(!n.ok)throw new Error("Error getting comments by id");const{commentsLength:o}=await n.json();return o}const ro=t=>V({queryKey:["comments-length",t],queryFn:()=>Tn(t)});async function yn(t){const n=await b.api.v0.votes.$post({json:t});if(!n.ok){let s="There was an issue creating your vote :( We'll look into it ASAP!";try{const a=await n.json();a&&typeof a=="object"&&"message"in a&&(s=String(a.message))}catch(a){console.error("Failed to parse error response:",a)}throw new Error(s)}const o=await n.json();if(!o.vote)throw new Error("Invalid response from server");return o.vote}const An=t=>{const n=ce();return ue({mutationFn:yn,onSuccess:o=>{n.invalidateQueries({queryKey:["user-vote",o.postId,o.userId]}),n.invalidateQueries({queryKey:["votes-summary",o.postId]})},onError:o=>{}})};async function _n(t){const n=await b.api.v0.votes[":postId"].$get({param:{postId:t.toString()}});if(!n.ok)throw new Error("Error getting votes by postId");const{votes:o}=await n.json();return o}const so=t=>V({queryKey:["post-votes",t],queryFn:()=>_n(t)});async function Sn(t){const n=await b.api.v0.votes.update.$post({json:t});if(!n.ok){let s="There was an issue updating your vote :( We'll look into it ASAP!";throw console.log(t),new Error(s)}const{vote:o}=await n.json();return o}const vn=t=>{const n=ce();return ue({mutationFn:Sn,onSuccess:o=>{n.invalidateQueries({queryKey:["comment-votes",o.commentId]}),n.invalidateQueries({queryKey:["user-vote",o.postId,o.userId]}),n.invalidateQueries({queryKey:["votes-summary",o.postId]})},onError:o=>{}})};async function In(t){const n=await b.api.v0.votes.comments[":commentId"].$get({param:{commentId:t.toString()}});if(!n.ok)throw new Error("Error getting comment votes by commentId");const{votes:o}=await n.json();return o}const io=t=>V({queryKey:["comment-votes",t],queryFn:()=>In(t)});async function wn(t){const n=await b.api.v0.votes.post.summary[":postId"].$get({param:{postId:t.toString()}});if(!n.ok)throw new Error("Error getting votes by postId");return await n.json()}const Rn=t=>V({queryKey:["votes-summary",t],queryFn:()=>wn(t)});async function xn(t,n){const o=await b.api.v0.votes.post.user[":postId"][":userId"].$get({param:{postId:t.toString(),userId:n.toString()}});if(!o.ok)throw new Error("Error getting user vote by postId");return await o.json()}const Cn=(t,n)=>V({queryKey:["user-vote",t,n],queryFn:()=>xn(t,n)});function ao(t){const{mutate:n,isPending:o}=An(),{mutate:s,isPending:a}=vn(),{user:f}=Lt(),_=Dt(),{data:L,isLoading:k,error:M}=Ke(Rn(t.post.postId)),{data:O,isLoading:G,error:T}=Ke(Cn(t.post.postId,f&&f.userId||""));function C(m,Ie,fe){if(m.preventDefault(),m.stopPropagation(),!(o||a)){if(!f){_({to:"/login"});return}O&&O.voted?s({voteId:O.voteId,value:fe}):f?n({userId:f&&f.userId||"",postId:Ie.postId,value:fe}):_({to:"/login"})}}return c.jsx("div",{children:c.jsxs("div",{className:"flex bg-[#3e3e3e] w-fit rounded-full py-1 justify-center",children:[f?G?c.jsx(c.Fragment,{children:"Loading..."}):T?c.jsx(c.Fragment,{children:"Error loading user vote"}):O?O.value===1?c.jsx("div",{onClick:m=>{C(m,t.post,0)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:a?"Updating...":c.jsx(fn,{size:20})}):c.jsx("div",{onClick:m=>{C(m,t.post,1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:c.jsx(He,{size:20})}):c.jsx("div",{onClick:m=>{C(m,t.post,1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:o?"Voting...":c.jsx(He,{size:20})}):c.jsx("div",{onClick:m=>{C(m,t.post,1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:o?"Voting...":c.jsx(He,{size:20})}),c.jsx("div",{className:"font-semibold",children:k?c.jsx("div",{children:"Loading..."}):M?c.jsx("div",{children:"Error loading votes"}):L?L.score:0}),f?G?c.jsx(c.Fragment,{children:"Loading..."}):T?c.jsx(c.Fragment,{children:"Error loading user vote"}):O?O.value===-1?c.jsx("div",{onClick:m=>{C(m,t.post,0)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:a?"Updating...":c.jsx(mn,{size:20})}):O.value===0?c.jsx("div",{onClick:m=>{C(m,t.post,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:a?"Updating...":c.jsx(Ae,{size:20})}):c.jsx("div",{onClick:m=>{C(m,t.post,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:a?"Updating...":c.jsx(Ae,{size:20})}):c.jsx("div",{onClick:m=>{C(m,t.post,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:o?"Voting...":c.jsx(Ae,{size:20})}):c.jsx("div",{onClick:m=>{C(m,t.post,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:o?"Voting...":c.jsx(Ae,{size:20})})]})})}function lo(t){const n=typeof t=="string"?new Date(t.replace(" ","T")+"Z"):t,o=Date.now();let s=Math.floor((o-n.getTime())/1e3);const a=new Intl.RelativeTimeFormat("en",{numeric:"auto"});if(s<60)return a.format(-s,"second");const f=Math.floor(s/60);if(f<60)return a.format(-f,"minute");const _=Math.floor(f/60);if(_<24)return a.format(-_,"hour");const L=Math.floor(_/24);if(L<30)return a.format(-L,"day");const k=Math.floor(L/30);if(k<12)return a.format(-k,"month");const M=Math.floor(k/12);return a.format(-M,"year")}function Nn(t){return nn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(t)}function co(t){const n=St.useRef(null),{user:o}=Lt(),{setEditPostModePointer:s}=on(),a=Dt(),{mutate:f,isPending:_}=rn(),{data:L}=Ke(sn(o&&o.userId||"")),k=!!L?.some(T=>T.postId===t.post.postId),{mutate:M,isPending:O}=an();function G(T){n.current&&!n.current.contains(T.target)&&t.setShowMenu(!1)}return St.useEffect(()=>(document.addEventListener("click",G),()=>document.removeEventListener("click",G)),[]),c.jsxs("div",{ref:n,className:"absolute top-12 right-2 py-2 px-5 rounded bg-[#222222] shadow-[0_0_15px_rgba(0,0,0,0.7)] z-40",children:[o&&t.post.userId===o.userId&&c.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[c.jsx(Nn,{size:20,className:"pt-1"}),c.jsx("div",{onClick:()=>{s(t.post.postId),a({to:`/posts/${t.post.postId}`}),t.setShowMenu(!1)},className:"ml-2",children:"Edit"})]}),k?c.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[c.jsx(ln,{size:20,className:"pt-1"}),c.jsx("div",{onClick:T=>{if(T.stopPropagation(),T.preventDefault(),!o)return a({to:"/login"});O||M({userId:o.userId||"",postId:t.post.postId},{onSuccess:()=>t.setShowMenu(!1)})},className:"ml-2",children:O?"Removing...":"Remove from saved"})]}):c.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[c.jsx(cn,{size:20,className:"pt-1"}),c.jsx("div",{onClick:T=>{if(T.stopPropagation(),T.preventDefault(),!o)return a({to:"/login"});_||f({userId:o.userId||"",postId:t.post.postId},{onSuccess:()=>t.setShowMenu(!1)})},className:"ml-2",children:_?"Saving...":"Save"})]}),o&&t.post.userId===o.userId&&c.jsxs("div",{onClick:T=>{T.stopPropagation(),T.preventDefault(),t.setDeleteMode(!0),t.setShowMenu(!1)},className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[c.jsx(un,{size:20,className:"pt-1 "}),c.jsx("div",{className:"ml-2",children:"Delete"})]})]})}/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Mt,setPrototypeOf:vt,isFrozen:On,getPrototypeOf:Ln,getOwnPropertyDescriptor:Dn}=Object;let{freeze:R,seal:D,create:$e}=Object,{apply:Qe,construct:Xe}=typeof Reflect<"u"&&Reflect;R||(R=function(n){return n});D||(D=function(n){return n});Qe||(Qe=function(n,o){for(var s=arguments.length,a=new Array(s>2?s-2:0),f=2;f<s;f++)a[f-2]=arguments[f];return n.apply(o,a)});Xe||(Xe=function(n){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];return new n(...s)});const _e=x(Array.prototype.forEach),bn=x(Array.prototype.lastIndexOf),It=x(Array.prototype.pop),re=x(Array.prototype.push),Mn=x(Array.prototype.splice),ve=x(String.prototype.toLowerCase),Be=x(String.prototype.toString),Ge=x(String.prototype.match),se=x(String.prototype.replace),Pn=x(String.prototype.indexOf),kn=x(String.prototype.trim),P=x(Object.prototype.hasOwnProperty),w=x(RegExp.prototype.test),ie=Fn(TypeError);function x(t){return function(n){n instanceof RegExp&&(n.lastIndex=0);for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];return Qe(t,n,s)}}function Fn(t){return function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return Xe(t,o)}}function u(t,n){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ve;vt&&vt(t,null);let s=n.length;for(;s--;){let a=n[s];if(typeof a=="string"){const f=o(a);f!==a&&(On(n)||(n[s]=f),a=f)}t[a]=!0}return t}function Un(t){for(let n=0;n<t.length;n++)P(t,n)||(t[n]=null);return t}function j(t){const n=$e(null);for(const[o,s]of Mt(t))P(t,o)&&(Array.isArray(s)?n[o]=Un(s):s&&typeof s=="object"&&s.constructor===Object?n[o]=j(s):n[o]=s);return n}function ae(t,n){for(;t!==null;){const s=Dn(t,n);if(s){if(s.get)return x(s.get);if(typeof s.value=="function")return x(s.value)}t=Ln(t)}function o(){return null}return o}const wt=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),We=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qe=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),jn=R(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ve=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),zn=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Rt=R(["#text"]),xt=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ye=R(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ct=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Se=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Hn=D(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bn=D(/<%[\w\W]*|[\w\W]*%>/gm),Gn=D(/\$\{[\w\W]*/gm),Wn=D(/^data-[\-\w.\u00B7-\uFFFF]+$/),qn=D(/^aria-[\-\w]+$/),Pt=D(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Vn=D(/^(?:\w+script|data):/i),Yn=D(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),kt=D(/^html$/i),Kn=D(/^[a-z][.\w]*(-[.\w]+)+$/i);var Nt=Object.freeze({__proto__:null,ARIA_ATTR:qn,ATTR_WHITESPACE:Yn,CUSTOM_ELEMENT:Kn,DATA_ATTR:Wn,DOCTYPE_NAME:kt,ERB_EXPR:Bn,IS_ALLOWED_URI:Pt,IS_SCRIPT_OR_DATA:Vn,MUSTACHE_EXPR:Hn,TMPLIT_EXPR:Gn});const le={element:1,text:3,progressingInstruction:7,comment:8,document:9},$n=function(){return typeof window>"u"?null:window},Qn=function(n,o){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let s=null;const a="data-tt-policy-suffix";o&&o.hasAttribute(a)&&(s=o.getAttribute(a));const f="dompurify"+(s?"#"+s:"");try{return n.createPolicy(f,{createHTML(_){return _},createScriptURL(_){return _}})}catch{return console.warn("TrustedTypes policy "+f+" could not be created."),null}},Ot=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ft(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$n();const n=l=>Ft(l);if(n.version="3.3.1",n.removed=[],!t||!t.document||t.document.nodeType!==le.document||!t.Element)return n.isSupported=!1,n;let{document:o}=t;const s=o,a=s.currentScript,{DocumentFragment:f,HTMLTemplateElement:_,Node:L,Element:k,NodeFilter:M,NamedNodeMap:O=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:G,DOMParser:T,trustedTypes:C}=t,m=k.prototype,Ie=ae(m,"cloneNode"),fe=ae(m,"remove"),Ut=ae(m,"nextSibling"),jt=ae(m,"childNodes"),me=ae(m,"parentNode");if(typeof _=="function"){const l=o.createElement("template");l.content&&l.content.ownerDocument&&(o=l.content.ownerDocument)}let v,ee="";const{implementation:we,createNodeIterator:zt,createDocumentFragment:Ht,getElementsByTagName:Bt}=o,{importNode:Gt}=s;let I=Ot();n.isSupported=typeof Mt=="function"&&typeof me=="function"&&we&&we.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Re,ERB_EXPR:xe,TMPLIT_EXPR:Ce,DATA_ATTR:Wt,ARIA_ATTR:qt,IS_SCRIPT_OR_DATA:Vt,ATTR_WHITESPACE:Ze,CUSTOM_ELEMENT:Yt}=Nt;let{IS_ALLOWED_URI:Je}=Nt,E=null;const et=u({},[...wt,...We,...qe,...Ve,...Rt]);let y=null;const tt=u({},[...xt,...Ye,...Ct,...Se]);let d=Object.seal($e(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),te=null,Ne=null;const Y=Object.seal($e(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let nt=!0,Oe=!0,ot=!1,rt=!0,K=!1,pe=!0,W=!1,Le=!1,De=!1,$=!1,de=!1,ge=!1,st=!0,it=!1;const Kt="user-content-";let be=!0,ne=!1,Q={},F=null;const Me=u({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let at=null;const lt=u({},["audio","video","img","source","image","track"]);let Pe=null;const ct=u({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),he="http://www.w3.org/1998/Math/MathML",Ee="http://www.w3.org/2000/svg",z="http://www.w3.org/1999/xhtml";let X=z,ke=!1,Fe=null;const $t=u({},[he,Ee,z],Be);let Te=u({},["mi","mo","mn","ms","mtext"]),ye=u({},["annotation-xml"]);const Qt=u({},["title","style","font","a","script"]);let oe=null;const Xt=["application/xhtml+xml","text/html"],Zt="text/html";let h=null,Z=null;const Jt=o.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},Ue=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Z&&Z===e)){if((!e||typeof e!="object")&&(e={}),e=j(e),oe=Xt.indexOf(e.PARSER_MEDIA_TYPE)===-1?Zt:e.PARSER_MEDIA_TYPE,h=oe==="application/xhtml+xml"?Be:ve,E=P(e,"ALLOWED_TAGS")?u({},e.ALLOWED_TAGS,h):et,y=P(e,"ALLOWED_ATTR")?u({},e.ALLOWED_ATTR,h):tt,Fe=P(e,"ALLOWED_NAMESPACES")?u({},e.ALLOWED_NAMESPACES,Be):$t,Pe=P(e,"ADD_URI_SAFE_ATTR")?u(j(ct),e.ADD_URI_SAFE_ATTR,h):ct,at=P(e,"ADD_DATA_URI_TAGS")?u(j(lt),e.ADD_DATA_URI_TAGS,h):lt,F=P(e,"FORBID_CONTENTS")?u({},e.FORBID_CONTENTS,h):Me,te=P(e,"FORBID_TAGS")?u({},e.FORBID_TAGS,h):j({}),Ne=P(e,"FORBID_ATTR")?u({},e.FORBID_ATTR,h):j({}),Q=P(e,"USE_PROFILES")?e.USE_PROFILES:!1,nt=e.ALLOW_ARIA_ATTR!==!1,Oe=e.ALLOW_DATA_ATTR!==!1,ot=e.ALLOW_UNKNOWN_PROTOCOLS||!1,rt=e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,K=e.SAFE_FOR_TEMPLATES||!1,pe=e.SAFE_FOR_XML!==!1,W=e.WHOLE_DOCUMENT||!1,$=e.RETURN_DOM||!1,de=e.RETURN_DOM_FRAGMENT||!1,ge=e.RETURN_TRUSTED_TYPE||!1,De=e.FORCE_BODY||!1,st=e.SANITIZE_DOM!==!1,it=e.SANITIZE_NAMED_PROPS||!1,be=e.KEEP_CONTENT!==!1,ne=e.IN_PLACE||!1,Je=e.ALLOWED_URI_REGEXP||Pt,X=e.NAMESPACE||z,Te=e.MATHML_TEXT_INTEGRATION_POINTS||Te,ye=e.HTML_INTEGRATION_POINTS||ye,d=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(d.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(d.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(d.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),K&&(Oe=!1),de&&($=!0),Q&&(E=u({},Rt),y=[],Q.html===!0&&(u(E,wt),u(y,xt)),Q.svg===!0&&(u(E,We),u(y,Ye),u(y,Se)),Q.svgFilters===!0&&(u(E,qe),u(y,Ye),u(y,Se)),Q.mathMl===!0&&(u(E,Ve),u(y,Ct),u(y,Se))),e.ADD_TAGS&&(typeof e.ADD_TAGS=="function"?Y.tagCheck=e.ADD_TAGS:(E===et&&(E=j(E)),u(E,e.ADD_TAGS,h))),e.ADD_ATTR&&(typeof e.ADD_ATTR=="function"?Y.attributeCheck=e.ADD_ATTR:(y===tt&&(y=j(y)),u(y,e.ADD_ATTR,h))),e.ADD_URI_SAFE_ATTR&&u(Pe,e.ADD_URI_SAFE_ATTR,h),e.FORBID_CONTENTS&&(F===Me&&(F=j(F)),u(F,e.FORBID_CONTENTS,h)),e.ADD_FORBID_CONTENTS&&(F===Me&&(F=j(F)),u(F,e.ADD_FORBID_CONTENTS,h)),be&&(E["#text"]=!0),W&&u(E,["html","head","body"]),E.table&&(u(E,["tbody"]),delete te.tbody),e.TRUSTED_TYPES_POLICY){if(typeof e.TRUSTED_TYPES_POLICY.createHTML!="function")throw ie('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof e.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ie('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=e.TRUSTED_TYPES_POLICY,ee=v.createHTML("")}else v===void 0&&(v=Qn(C,a)),v!==null&&typeof ee=="string"&&(ee=v.createHTML(""));R&&R(e),Z=e}},ft=u({},[...We,...qe,...jn]),mt=u({},[...Ve,...zn]),en=function(e){let r=me(e);(!r||!r.tagName)&&(r={namespaceURI:X,tagName:"template"});const i=ve(e.tagName),p=ve(r.tagName);return Fe[e.namespaceURI]?e.namespaceURI===Ee?r.namespaceURI===z?i==="svg":r.namespaceURI===he?i==="svg"&&(p==="annotation-xml"||Te[p]):!!ft[i]:e.namespaceURI===he?r.namespaceURI===z?i==="math":r.namespaceURI===Ee?i==="math"&&ye[p]:!!mt[i]:e.namespaceURI===z?r.namespaceURI===Ee&&!ye[p]||r.namespaceURI===he&&!Te[p]?!1:!mt[i]&&(Qt[i]||!ft[i]):!!(oe==="application/xhtml+xml"&&Fe[e.namespaceURI]):!1},U=function(e){re(n.removed,{element:e});try{me(e).removeChild(e)}catch{fe(e)}},q=function(e,r){try{re(n.removed,{attribute:r.getAttributeNode(e),from:r})}catch{re(n.removed,{attribute:null,from:r})}if(r.removeAttribute(e),e==="is")if($||de)try{U(r)}catch{}else try{r.setAttribute(e,"")}catch{}},pt=function(e){let r=null,i=null;if(De)e="<remove></remove>"+e;else{const g=Ge(e,/^[\r\n\t ]+/);i=g&&g[0]}oe==="application/xhtml+xml"&&X===z&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const p=v?v.createHTML(e):e;if(X===z)try{r=new T().parseFromString(p,oe)}catch{}if(!r||!r.documentElement){r=we.createDocument(X,"template",null);try{r.documentElement.innerHTML=ke?ee:p}catch{}}const S=r.body||r.documentElement;return e&&i&&S.insertBefore(o.createTextNode(i),S.childNodes[0]||null),X===z?Bt.call(r,W?"html":"body")[0]:W?r.documentElement:S},dt=function(e){return zt.call(e.ownerDocument||e,e,M.SHOW_ELEMENT|M.SHOW_COMMENT|M.SHOW_TEXT|M.SHOW_PROCESSING_INSTRUCTION|M.SHOW_CDATA_SECTION,null)},je=function(e){return e instanceof G&&(typeof e.nodeName!="string"||typeof e.textContent!="string"||typeof e.removeChild!="function"||!(e.attributes instanceof O)||typeof e.removeAttribute!="function"||typeof e.setAttribute!="function"||typeof e.namespaceURI!="string"||typeof e.insertBefore!="function"||typeof e.hasChildNodes!="function")},gt=function(e){return typeof L=="function"&&e instanceof L};function H(l,e,r){_e(l,i=>{i.call(n,e,r,Z)})}const ht=function(e){let r=null;if(H(I.beforeSanitizeElements,e,null),je(e))return U(e),!0;const i=h(e.nodeName);if(H(I.uponSanitizeElement,e,{tagName:i,allowedTags:E}),pe&&e.hasChildNodes()&&!gt(e.firstElementChild)&&w(/<[/\w!]/g,e.innerHTML)&&w(/<[/\w!]/g,e.textContent)||e.nodeType===le.progressingInstruction||pe&&e.nodeType===le.comment&&w(/<[/\w]/g,e.data))return U(e),!0;if(!(Y.tagCheck instanceof Function&&Y.tagCheck(i))&&(!E[i]||te[i])){if(!te[i]&&Tt(i)&&(d.tagNameCheck instanceof RegExp&&w(d.tagNameCheck,i)||d.tagNameCheck instanceof Function&&d.tagNameCheck(i)))return!1;if(be&&!F[i]){const p=me(e)||e.parentNode,S=jt(e)||e.childNodes;if(S&&p){const g=S.length;for(let N=g-1;N>=0;--N){const B=Ie(S[N],!0);B.__removalCount=(e.__removalCount||0)+1,p.insertBefore(B,Ut(e))}}}return U(e),!0}return e instanceof k&&!en(e)||(i==="noscript"||i==="noembed"||i==="noframes")&&w(/<\/no(script|embed|frames)/i,e.innerHTML)?(U(e),!0):(K&&e.nodeType===le.text&&(r=e.textContent,_e([Re,xe,Ce],p=>{r=se(r,p," ")}),e.textContent!==r&&(re(n.removed,{element:e.cloneNode()}),e.textContent=r)),H(I.afterSanitizeElements,e,null),!1)},Et=function(e,r,i){if(st&&(r==="id"||r==="name")&&(i in o||i in Jt))return!1;if(!(Oe&&!Ne[r]&&w(Wt,r))){if(!(nt&&w(qt,r))){if(!(Y.attributeCheck instanceof Function&&Y.attributeCheck(r,e))){if(!y[r]||Ne[r]){if(!(Tt(e)&&(d.tagNameCheck instanceof RegExp&&w(d.tagNameCheck,e)||d.tagNameCheck instanceof Function&&d.tagNameCheck(e))&&(d.attributeNameCheck instanceof RegExp&&w(d.attributeNameCheck,r)||d.attributeNameCheck instanceof Function&&d.attributeNameCheck(r,e))||r==="is"&&d.allowCustomizedBuiltInElements&&(d.tagNameCheck instanceof RegExp&&w(d.tagNameCheck,i)||d.tagNameCheck instanceof Function&&d.tagNameCheck(i))))return!1}else if(!Pe[r]){if(!w(Je,se(i,Ze,""))){if(!((r==="src"||r==="xlink:href"||r==="href")&&e!=="script"&&Pn(i,"data:")===0&&at[e])){if(!(ot&&!w(Vt,se(i,Ze,"")))){if(i)return!1}}}}}}}return!0},Tt=function(e){return e!=="annotation-xml"&&Ge(e,Yt)},yt=function(e){H(I.beforeSanitizeAttributes,e,null);const{attributes:r}=e;if(!r||je(e))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:y,forceKeepAttr:void 0};let p=r.length;for(;p--;){const S=r[p],{name:g,namespaceURI:N,value:B}=S,J=h(g),ze=B;let A=g==="value"?ze:kn(ze);if(i.attrName=J,i.attrValue=A,i.keepAttr=!0,i.forceKeepAttr=void 0,H(I.uponSanitizeAttribute,e,i),A=i.attrValue,it&&(J==="id"||J==="name")&&(q(g,e),A=Kt+A),pe&&w(/((--!?|])>)|<\/(style|title|textarea)/i,A)){q(g,e);continue}if(J==="attributename"&&Ge(A,"href")){q(g,e);continue}if(i.forceKeepAttr)continue;if(!i.keepAttr){q(g,e);continue}if(!rt&&w(/\/>/i,A)){q(g,e);continue}K&&_e([Re,xe,Ce],_t=>{A=se(A,_t," ")});const At=h(e.nodeName);if(!Et(At,J,A)){q(g,e);continue}if(v&&typeof C=="object"&&typeof C.getAttributeType=="function"&&!N)switch(C.getAttributeType(At,J)){case"TrustedHTML":{A=v.createHTML(A);break}case"TrustedScriptURL":{A=v.createScriptURL(A);break}}if(A!==ze)try{N?e.setAttributeNS(N,g,A):e.setAttribute(g,A),je(e)?U(e):It(n.removed)}catch{q(g,e)}}H(I.afterSanitizeAttributes,e,null)},tn=function l(e){let r=null;const i=dt(e);for(H(I.beforeSanitizeShadowDOM,e,null);r=i.nextNode();)H(I.uponSanitizeShadowNode,r,null),ht(r),yt(r),r.content instanceof f&&l(r.content);H(I.afterSanitizeShadowDOM,e,null)};return n.sanitize=function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=null,i=null,p=null,S=null;if(ke=!l,ke&&(l="<!-->"),typeof l!="string"&&!gt(l))if(typeof l.toString=="function"){if(l=l.toString(),typeof l!="string")throw ie("dirty is not a string, aborting")}else throw ie("toString is not a function");if(!n.isSupported)return l;if(Le||Ue(e),n.removed=[],typeof l=="string"&&(ne=!1),ne){if(l.nodeName){const B=h(l.nodeName);if(!E[B]||te[B])throw ie("root node is forbidden and cannot be sanitized in-place")}}else if(l instanceof L)r=pt("<!---->"),i=r.ownerDocument.importNode(l,!0),i.nodeType===le.element&&i.nodeName==="BODY"||i.nodeName==="HTML"?r=i:r.appendChild(i);else{if(!$&&!K&&!W&&l.indexOf("<")===-1)return v&&ge?v.createHTML(l):l;if(r=pt(l),!r)return $?null:ge?ee:""}r&&De&&U(r.firstChild);const g=dt(ne?l:r);for(;p=g.nextNode();)ht(p),yt(p),p.content instanceof f&&tn(p.content);if(ne)return l;if($){if(de)for(S=Ht.call(r.ownerDocument);r.firstChild;)S.appendChild(r.firstChild);else S=r;return(y.shadowroot||y.shadowrootmode)&&(S=Gt.call(s,S,!0)),S}let N=W?r.outerHTML:r.innerHTML;return W&&E["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&w(kt,r.ownerDocument.doctype.name)&&(N="<!DOCTYPE "+r.ownerDocument.doctype.name+`>
`+N),K&&_e([Re,xe,Ce],B=>{N=se(N,B," ")}),v&&ge?v.createHTML(N):N},n.setConfig=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ue(l),Le=!0},n.clearConfig=function(){Z=null,Le=!1},n.isValidAttribute=function(l,e,r){Z||Ue({});const i=h(l),p=h(e);return Et(i,p,r)},n.addHook=function(l,e){typeof e=="function"&&re(I[l],e)},n.removeHook=function(l,e){if(e!==void 0){const r=bn(I[l],e);return r===-1?void 0:Mn(I[l],r,1)[0]}return It(I[l])},n.removeHooks=function(l){I[l]=[]},n.removeAllHooks=function(){I=Ot()},n}var uo=Ft();export{Nn as F,co as M,ao as V,ro as a,so as b,Jn as c,lo as d,no as e,eo as f,oo as g,io as h,An as i,vn as j,uo as p,to as u};
