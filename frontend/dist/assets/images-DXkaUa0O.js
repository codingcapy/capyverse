import{C as s,D as a,E as o,G as i}from"./index-brlHAl5i.js";function u(e){return{...e,createdAt:new Date(e.createdAt)}}function w(){const e=o();return i({mutationFn:async({userId:t,file:r,postId:g})=>{new FormData().append("file",r);const n=await(await a.api.v0.images.upload.$post({form:{userId:t,file:r,postId:g}})).json();if(!n.success)throw new Error(n.error);return{cloudFrontUrl:n.cloudFrontUrl,userId:t}},onSettled:t=>{if(!t)return console.log(t,"create args, returning");e.invalidateQueries({queryKey:["images",t.userId]}),e.invalidateQueries({queryKey:["images"]})}})}async function m(e){const t=await a.api.v0.images[":postId"].$get({param:{postId:e.toString()}});if(!t.ok)throw new Error("Error getting images by request");const{images:r}=await t.json();return r.map(u)}const I=e=>s({queryKey:["images",e],queryFn:()=>m(e)});async function c(e){const t=await a.api.v0.images.user[":userId"].$get({param:{userId:e.toString()}});if(!t.ok)throw new Error("Error getting images by request");const{images:r}=await t.json();return r.map(u)}const f=e=>s({queryKey:["images",e],queryFn:()=>c(e)});async function y(e){const t=await a.api.v0.images.delete.$post({json:e});if(!t.ok)throw new Error("Error deleting image.");const{newImage:r}=await t.json();return console.log(r),r}const q=()=>{const e=o();return i({mutationFn:y,onSettled:t=>{t&&(e.invalidateQueries({queryKey:["images",t.postId]}),e.invalidateQueries({queryKey:["images"]}))}})};export{q as a,I as b,f as g,w as u};
