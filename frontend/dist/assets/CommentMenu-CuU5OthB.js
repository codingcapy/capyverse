import{u as I,a as h,j as t,r as v,e as p,F as N,o as C}from"./index-DH8edUD2.js";import{u as P}from"./images-oa0gbZYx.js";import{i as y,j as k,k as w,l as E,m as F,n as V,o as z,F as D}from"./purify.es-D1iv5A1_.js";function L(n){const{data:o,isLoading:i,isError:c}=P(y(n.comment.commentId)),{mutate:d,isPending:a}=k(),{mutate:m,isPending:j}=w(),{user:s}=I(),g=h();function l(e,r,u){if(e.preventDefault(),e.stopPropagation(),a||j)return;const f=o&&o.find(x=>x.commentId===n.comment.commentId&&s&&x.userId===s.userId);s&&f?m({voteId:f.voteId,value:u}):s?d({userId:s&&s.userId||"",postId:r.postId,commentId:r.commentId,value:u}):g({to:"/login"})}return t.jsx("div",{children:c?t.jsx("div",{children:"Error fetching votes"}):i?t.jsx("div",{children:"Loading..."}):o?t.jsxs("div",{className:"flex w-fit rounded-full py-1 justify-center",children:[o.filter(e=>e.commentId===n.comment.commentId&&s&&e.userId===s.userId&&e.value===1).length>0?t.jsx("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),m({voteId:o.find(r=>r.commentId===n.comment.commentId&&s&&r.userId===s.userId&&r.value===1).voteId,value:0})},className:"pr-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(E,{size:20})}):t.jsx("div",{onClick:e=>{l(e,n.comment,1)},className:"pr-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(F,{size:20})}),t.jsx("div",{className:"",children:o.filter(e=>e.commentId===n.comment.commentId).reduce((e,r)=>e+r.value,0)}),o.filter(e=>e.commentId===n.comment.commentId&&s&&e.userId===s.userId&&e.value===-1).length>0?t.jsx("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),m({voteId:o.find(r=>r.commentId===n.comment.commentId&&s&&r.userId===s.userId&&r.value===-1).voteId,value:0})},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(V,{size:20})}):t.jsx("div",{onClick:e=>{l(e,n.comment,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:t.jsx(z,{size:20})})]}):t.jsx("div",{children:"An unexpected error has occured"})})}function R(n){const o=v.useRef(null),{user:i}=I(),{setEditCommentModePointer:c}=p();h();function d(a){o.current&&!o.current.contains(a.target)&&n.setShowMenu(!1)}return v.useEffect(()=>(document.addEventListener("click",d),()=>document.removeEventListener("click",d)),[]),t.jsxs("div",{ref:o,className:"absolute top-12 right-2 py-2 px-5 rounded bg-[#222222] shadow-[0_0_15px_rgba(0,0,0,0.7)] z-40",children:[i&&n.comment.userId===i.userId&&t.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[t.jsx(D,{size:20,className:"pt-1"}),t.jsx("div",{onClick:()=>{c(n.comment.commentId),n.setCommentContent(n.comment.content||""),n.setShowMenu(!1)},className:"ml-2",children:"Edit"})]}),t.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[t.jsx(N,{size:20,className:"pt-1"}),t.jsx("div",{className:"ml-2",children:"Save"})]}),i&&n.comment.userId===i.userId&&t.jsxs("div",{onClick:a=>{a.stopPropagation(),a.preventDefault(),n.setDeleteMode(!0),n.setShowMenu(!1)},className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[t.jsx(C,{size:20,className:"pt-1 "}),t.jsx("div",{className:"ml-2",children:"Delete"})]})]})}export{L as C,R as a};
