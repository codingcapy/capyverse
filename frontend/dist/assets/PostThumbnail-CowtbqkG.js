import{r as h,v as I,u as L,b as i,j as e,L as w,d as n,I as P}from"./index-DxjmVo-m.js";import{F as E}from"./index-D-IaAD-6.js";import{a as D,d as A,p as C,V as M,M as O}from"./purify.es-UOXt2loz.js";import{g as T}from"./users-aDagHdFE.js";import{c as k}from"./images-BwW3ioxI.js";function R(s){const[d,l]=h.useState(!1),[c,r]=h.useState(!1),{mutate:f,isPending:m}=I(),{user:a}=L(),{data:o,isLoading:u,error:x}=i(T(s.post.userId)),{data:p,isLoading:g,error:j}=i(k(s.post.postId)),{data:v,isLoading:b,error:y}=i(D(s.post.postId));return e.jsxs("div",{className:"mx-auto w-full md:w-[50%] 2xl:w-[750px] border-t border-[#636363]",children:[e.jsxs(w,{to:"/posts/$postId",params:{postId:s.post.postId.toString()},children:[e.jsxs("div",{className:"relative my-1 rounded py-2 px-4 hover:bg-[#333333] transition-all ease-in-out duration-300",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex text-[#bdbdbd] text-sm",children:[e.jsx("img",{src:!u||x?o?o.profilePic?o.profilePic:n:n:n,alt:"",className:"w-6 h-6 rounded-full"}),u?e.jsx("div",{children:"Loading..."}):x?e.jsx("div",{children:"Unknown author"}):o?e.jsx("div",{className:"font-bold ml-2",children:o.username}):e.jsx("div",{children:"Unknown author"}),e.jsx("div",{className:"px-1",children:"•"}),e.jsx("div",{children:A(s.post.createdAt)})]}),e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),l(!d)},className:"absolute top-1 right-1 p-3 rounded-full hover:bg-[#575757] transition-all ease-in-out duration-300",children:e.jsx(E,{})})]}),e.jsx("div",{className:"text-xl md:text-2xl font-semibold",children:s.post.title}),g?e.jsx("div",{children:"Loading..."}):j?e.jsx("div",{children:"Error loading images"}):p?p.map((t,N)=>{if(N<1)return e.jsx("div",{className:"w-full h-[220px] sm:h-[300px] md:h-[400px] xl:h-[500px] border border-[#424242] bg-[#202020] rounded-xl my-2 flex items-center justify-center",children:e.jsx("img",{src:`https://${t.imageUrl}`,alt:"",className:"w-full h-full object-contain"})},t.imageId)}):e.jsx("div",{children:"An unexpected error has occured"}),e.jsx("div",{className:"my-2",children:e.jsx("div",{className:"line-clamp-4",dangerouslySetInnerHTML:{__html:C.sanitize(s.post.content,{ALLOWED_TAGS:["b","i","u","s","strong","em","ul","ol","li","p","a"],ALLOWED_ATTR:["href","target","rel"],FORBID_ATTR:["style"]})}})}),e.jsxs("div",{className:"flex",children:[e.jsx(M,{post:s.post}),e.jsxs("div",{className:"flex bg-[#3e3e3e] w-fit rounded-full py-1 justify-center ml-2 hover:text-cyan-500 transition-all ease-in-out duration-300",children:[e.jsx("div",{className:"pl-3 pr-1",children:e.jsx(P,{size:20})}),e.jsx("div",{className:"pr-3 font-semibold",children:b?"Loading...":y?"Error loading comments":v??0})]})]}),d&&e.jsx(O,{post:s.post,setDeleteMode:r,setShowMenu:l})]}),a&&s.post.userId===a.userId&&c&&e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-[#222222] p-6 rounded shadow-lg w-[90%] max-w-md text-center z-100",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Delete Post?"}),e.jsx("div",{className:"my-5",children:"Once you delete this post, it can’t be restored."}),e.jsxs("div",{className:"my-5 flex justify-end",children:[e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),!m&&(f({postId:s.post.postId}),r(!1))},className:"p-2 mr-1 bg-red-500 rounded text-white bold secondary-font font-bold cursor-pointer",children:m?"Deleting...":"DELETE"}),e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),r(!1)},className:"p-2 ml-1 bg-[#5c5c5c] rounded bold secondary-font font-bold cursor-pointer",children:"CANCEL"})]})]})]},s.post.postId),a&&s.post.userId===a.userId&&c&&e.jsx("div",{className:"fixed inset-0 bg-black opacity-50 z-90"})]})}export{R as P};
