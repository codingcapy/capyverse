import{u as x,a as h,j as e,r as v,d as g,F as N,k as C}from"./index-2FyFcRdi.js";import{u as P}from"./images-bFpD0ZVn.js";import{j as k,k as y,l as w,m as E,n as F,o as V,p as z,F as D}from"./Menu-CsDM85Ci.js";function L(s){const{data:o,isLoading:i,isError:c}=P(k(s.comment.commentId)),{mutate:d,isPending:a}=y(),{mutate:l,isPending:I}=w(),{user:n}=x(),p=h();function u(t,r,m){if(t.preventDefault(),t.stopPropagation(),a||I)return;const f=o&&o.find(j=>n&&j.userId===n.userId);n&&f?l({voteId:f.voteId,value:m}):n?d({userId:n&&n.userId||"",postId:r.postId,commentId:r.commentId,value:m}):p({to:"/login"})}return e.jsx("div",{children:c?e.jsx("div",{children:"Error fetching votes"}):i?e.jsx("div",{children:"Loading..."}):o?e.jsxs("div",{className:"flex w-fit rounded-full py-1 justify-center",children:[o.filter(t=>n&&t.userId===n.userId&&t.value===1).length>0?e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),l({voteId:o.find(r=>r.postId===s.comment.postId&&n&&r.userId===n.userId&&r.value===1).voteId,value:0})},className:"pr-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:e.jsx(E,{size:20})}):e.jsx("div",{onClick:t=>{u(t,s.comment,1)},className:"pr-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:e.jsx(F,{size:20})}),e.jsx("div",{className:"",children:o.filter(t=>t.postId===s.comment.postId).reduce((t,r)=>t+r.value,0)}),o.filter(t=>n&&t.userId===n.userId&&t.value===-1).length>0?e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),l({voteId:o.find(r=>r.postId===s.comment.postId&&n&&r.userId===n.userId&&r.value===-1).voteId,value:0})},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:e.jsx(V,{size:20})}):e.jsx("div",{onClick:t=>{u(t,s.comment,-1)},className:"px-2 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:e.jsx(z,{size:20})})]}):e.jsx("div",{children:"An unexpected error has occured"})})}function R(s){const o=v.useRef(null),{user:i}=x(),{setEditCommentModePointer:c}=g();h();function d(a){o.current&&!o.current.contains(a.target)&&s.setShowMenu(!1)}return v.useEffect(()=>(document.addEventListener("click",d),()=>document.removeEventListener("click",d)),[]),e.jsxs("div",{ref:o,className:"absolute top-12 right-2 py-2 px-5 rounded bg-[#222222] shadow-[0_0_15px_rgba(0,0,0,0.7)] z-40",children:[i&&s.comment.userId===i.userId&&e.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[e.jsx(D,{size:20,className:"pt-1"}),e.jsx("div",{onClick:()=>{c(s.comment.commentId),s.setCommentContent(s.comment.content||""),s.setShowMenu(!1)},className:"ml-2",children:"Edit"})]}),e.jsxs("div",{className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[e.jsx(N,{size:20,className:"pt-1"}),e.jsx("div",{className:"ml-2",children:"Save"})]}),i&&s.comment.userId===i.userId&&e.jsxs("div",{onClick:a=>{a.stopPropagation(),a.preventDefault(),s.setDeleteMode(!0),s.setShowMenu(!1)},className:"flex py-2 hover:text-[#ffffff] cursor-pointer",children:[e.jsx(C,{size:20,className:"pt-1 "}),e.jsx("div",{className:"ml-2",children:"Delete"})]})]})}export{L as C,R as a};
