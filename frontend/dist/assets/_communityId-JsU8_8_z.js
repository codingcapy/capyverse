import{B as y,u as N,r as l,b as f,C as b,o as g,f as L,j as e,d as C}from"./index-CE7cCl86.js";import{b as E}from"./images-D29NfLbw.js";import{P as v}from"./PostThumbnail-B-uw436z.js";import{p as I}from"./purify.es-DoFBA_lZ.js";import"./index-AJGtjXI0.js";import"./users-neqRD6JE.js";function A(){const t=y.useRouteContext(),{user:n}=N(),[d,i]=l.useState(!1),[c,u]=l.useState("Popular"),a=l.useRef(null),{data:r,isLoading:m,error:x}=f(b(t.communityId)),{searchContent:o}=g(),{data:p,isLoading:j,error:w}=f(L(n&&n.userId||""));function h(s){a.current&&!a.current.contains(s.target)&&i(!1)}return l.useEffect(()=>(document.addEventListener("click",h),()=>document.removeEventListener("click",h)),[]),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"mx-auto w-full md:w-[50%] pt-[70px] pb-2",children:[e.jsxs("div",{className:"flex pt-10",children:[e.jsx("div",{className:"pt-5",children:e.jsx("img",{src:C,alt:"",className:"rounded-full w-[100px] h-[100px]"})}),e.jsxs("div",{className:"text-4xl font-bold pt-20 ml-2",children:["c/",t.communityId]})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{ref:a,className:"relative mx-auto w-full 2xl:w-[750px] flex pt-5",children:[e.jsxs("div",{onClick:()=>i(!d),className:"flex cursor-pointer pl-4 md:pl-0 md:pt-1 hover:text-cyan-500 transition-all ease-in-out duration-300",children:[e.jsx("div",{className:"text-xs",children:c}),e.jsx("div",{className:"ml-2",children:e.jsx(E,{})})]}),d&&e.jsxs("div",{onClick:()=>{},className:"absolute top-12 left-0 bg-[#444444] px-5 py-2 z-50 shadow-[0_0_15px_rgba(0,0,0,0.7)]",children:[e.jsx("div",{onClick:()=>{u("Popular"),i(!1)},className:" py-1 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:"Popular"}),e.jsx("div",{onClick:()=>{u("New"),i(!1)},className:"py-1 cursor-pointer hover:text-cyan-500 transition-all ease-in-out duration-300",children:"New"})]})]}),j?e.jsx("div",{children:"Loading..."}):w?e.jsx("div",{children:"Error loading communities"}):p?p.some(s=>s.communityId===t.communityId)?e.jsx("div",{className:"px-5 py-3 rounded-full border cursor-pointer hover:bg-[#333333] transition-all ease-in-out duration-300",children:"Joined"}):e.jsx("div",{className:"px-5 py-3 rounded-full bg-cyan-700 cursor-pointer hover:bg-cyan-500 transition-all ease-in-out duration-300",children:"Join"}):e.jsx("div",{})]})]}),c==="Popular"?e.jsxs("div",{className:"mx-auto flex 2xl:pl-80",children:[e.jsx("div",{children:m?e.jsx("div",{className:"mx-auto w-full md:w-[50%] 2xl:w-[750px] border-t border-[#636363]",children:"Loading..."}):x?e.jsx("div",{className:"mx-auto w-full md:w-[50%] 2xl:w-[750px] border-t border-[#636363]",children:"Error fetching posts"}):r?r.length>0?r.filter(s=>o===""||s.title.toLowerCase().includes(o.toLowerCase())||s.content.toLowerCase().includes(o.toLowerCase())).map(s=>e.jsx(v,{post:s},s.postId)):e.jsx("div",{className:"mx-auto w-full md:w-[50%] 2xl:w-[750px] border-t border-[#636363]"}):e.jsx("div",{className:"mx-auto w-full md:w-[50%] 2xl:w-[750px] border-t border-[#636363]"})}),e.jsxs("aside",{className:"hidden 2xl:block sticky top-[110px] h-[calc(100vh-150px)] w-[300px] ml-5 custom-scrollbar bg-[#111111] rounded-xl py-2 overflow-y-auto",children:[e.jsx("div",{className:"my-3 px-5 font-bold",children:t.communityId}),e.jsx("div",{className:"px-5 line-clamp-4",dangerouslySetInnerHTML:{__html:I.sanitize(t.description,{ALLOWED_TAGS:["b","i","u","s","strong","em","ul","ol","li","p","a"],ALLOWED_ATTR:["href","target","rel"],FORBID_ATTR:["style"]})}})]})]}):e.jsx("div",{children:m?e.jsx("div",{children:"Loading..."}):x?e.jsx("div",{children:"Error fetching posts"}):r?r.filter(s=>o===""||s.title.toLowerCase().includes(o.toLowerCase())||s.content.toLowerCase().includes(o.toLowerCase())).map(s=>e.jsx(v,{post:s},s.postId)):e.jsx("div",{})})]})})}export{A as component};
