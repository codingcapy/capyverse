import{u as a}from"./index-CmEL-dfM.js";import{u as i,c as n}from"./client-CATr2LOA.js";function u(r){return{...r,createdAt:new Date(r.createdAt)}}async function c(r){const e=await n.api.v0.posts.$post({json:r});if(!e.ok){let s="There was an issue creating your post :( We'll look into it ASAP!";try{const t=await e.json();t&&typeof t=="object"&&"message"in t&&(s=String(t.message))}catch(t){console.error("Failed to parse error response:",t)}throw new Error(s)}const o=await e.json();if(!o.user)throw new Error("Invalid response from server");return o.user}const w=r=>{const e=a();return i({mutationFn:c,onSettled:()=>{e.invalidateQueries({queryKey:["posts"]})},onError:o=>{}})};async function p(){const r=await n.api.v0.posts.$get();if(!r.ok)throw new Error("Error getting posts");const{posts:e}=await r.json();return e.map(u)}const f=()=>({queryKey:["posts"],queryFn:()=>p()});export{f as g,w as u};
