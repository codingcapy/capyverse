import{Q as v,B as f,C as p,D as P,E as b,b as u,j as s,d as g,L as N,G as j}from"./index-lSTVWf8_.js";import{g as y}from"./users-ChSwiFH4.js";import{i as L,j as E,d as I}from"./purify.es-Cwp3xoKe.js";var w=class extends v{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:f()})}getOptimisticResult(e){return e.behavior=f(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){const{state:r}=e,i=super.createResult(e,t),{isFetching:n,isRefetching:m,isError:c,isRefetchError:d}=i,o=r.fetchMeta?.fetchMore?.direction,h=c&&o==="forward",a=n&&o==="forward",l=c&&o==="backward",x=n&&o==="backward";return{...i,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:P(t,r.data),hasPreviousPage:p(t,r.data),isFetchNextPageError:h,isFetchingNextPage:a,isFetchPreviousPageError:l,isFetchingPreviousPage:x,isRefetchError:d&&!h&&!l,isRefetching:m&&!a&&!x}}};function M(e,t){return b(e,w)}function R(e){const{data:t,isLoading:r,error:i}=u(y(e.post.userId)),{data:n,isLoading:m,error:c}=u(L(e.post.postId)),{data:d,isLoading:o,isError:h}=u(E(e.post.postId));return s.jsxs("div",{className:"px-5 border-b border-[#222222] py-3",children:[s.jsxs("div",{className:"flex text-[#bdbdbd] text-sm",children:[s.jsx("img",{src:!r||i?t?t.profilePic?t.profilePic:g:g:g,alt:"",className:"w-6 h-6 rounded-full"}),r?s.jsx("div",{children:"Loading..."}):i?s.jsx("div",{children:"Unknown author"}):t?s.jsx("div",{className:"font-bold ml-2",children:t.username}):s.jsx("div",{children:"Unknown author"}),s.jsx("div",{className:"px-1",children:"â€¢"}),s.jsx("div",{children:I(e.post.createdAt)})]}),s.jsx(N,{to:"/posts/$postId",params:{postId:e.post.postId.toString()},className:"font-bold hover:underline",children:s.jsx("div",{className:"my-2",children:e.post.title})}),s.jsxs("div",{className:"flex",children:[s.jsxs("div",{className:"text-sm mr-2",children:[o?"Loading...":h?"error":d!==void 0?d.filter(a=>a.commentId===null).reduce((a,l)=>a+l.value,0):"error"," ","votes"]}),s.jsxs("div",{className:"text-sm",children:[m?"Loading...":c?"error":n," ","comments"]})]})]})}function S(){const{data:e,isLoading:t,error:r}=u(j());return s.jsx("aside",{className:"hidden 2xl:block sticky top-[110px] h-[calc(100vh-150px)] w-[300px] ml-5 overflow-y-auto custom-scrollbar",children:s.jsxs("div",{className:"bg-[#111111] rounded-xl pt-2 overflow-y-auto",children:[s.jsx("div",{className:"my-3 px-5",children:"RECENT POSTS"}),t?s.jsx("div",{className:"px-5 border-b border-[#222222] py-3",children:"Loading..."}):r?s.jsx("div",{className:"px-5 border-b border-[#222222] py-3",children:"Error fetching recent posts"}):e?e.map(i=>s.jsx(R,{post:i},i.postId)):s.jsx("div",{})]})})}export{S,M as u};
