import{Y as s,$ as n,a0 as i,Z as u,_ as g}from"./index-BCa0rqNy.js";function c(e){return{...e,createdAt:new Date(e.createdAt)}}function f(){const e=i(),t=u();return g({mutationFn:async({userId:r,file:a,postId:m})=>{new FormData().append("file",a);const o=await(await n.api.v0.images.upload.$post({form:{userId:r,file:a,postId:m}},e?{headers:{Authorization:`Bearer ${e}`}}:void 0)).json();if(!o.success)throw new Error(o.error);return{cloudFrontUrl:o.cloudFrontUrl,userId:r}},onSettled:r=>{if(!r)return console.log(r,"create args, returning");t.invalidateQueries({queryKey:["images",r.userId]}),t.invalidateQueries({queryKey:["images"]})}})}async function d(e){const t=await n.api.v0.images[":postId"].$get({param:{postId:e.toString()}});if(!t.ok)throw new Error("Error getting images by request");const{images:r}=await t.json();return r.map(c)}const q=e=>s({queryKey:["images",e],queryFn:()=>d(e)});async function y(e){const t=await n.api.v0.images.user[":userId"].$get({param:{userId:e.toString()}});if(!t.ok)throw new Error("Error getting images by request");const{images:r}=await t.json();return r.map(c)}const v=e=>s({queryKey:["images",e],queryFn:()=>y(e)});async function l(e){const t=i(),r=await n.api.v0.images.delete.$post({json:e},t?{headers:{Authorization:`Bearer ${t}`}}:void 0);if(!r.ok)throw new Error("Error deleting image.");const{newImage:a}=await r.json();return console.log(a),a}const h=()=>{const e=u();return g({mutationFn:l,onSettled:t=>{t&&(e.invalidateQueries({queryKey:["images",t.postId]}),e.invalidateQueries({queryKey:["images"]}))}})};export{h as a,q as b,v as g,f as u};
