import{r as g,w as D,u as k,b as l,k as A,j as e,L as C,d as i,I as O}from"./index-B-N3_Zbd.js";import{a as M}from"./index-ByQrjrmk.js";import{a as T,d as v,V as S,M as U}from"./Menu-BCs5-wP7.js";import{g as B}from"./users-e5GEBiL-.js";import{c as Q}from"./images-vd75vJ4R.js";import{p as _}from"./purify.es-A66Cw1IH.js";function G(s){const[m,u]=g.useState(!1),[x,c]=g.useState(!1),{mutate:b,isPending:h}=D(),{user:d}=k(),{data:o,isLoading:r,error:a}=l(B(s.post.userId)),{data:j,isLoading:y,error:N}=l(Q(s.post.postId)),{data:I,isLoading:L,error:w}=l(T(s.post.postId)),{data:n,isLoading:f,error:p}=l({...A(s.post.communityId),enabled:!!s.post.communityId}),P=!!s.post.communityId;return e.jsxs("div",{className:"mx-auto w-full md:w-[50%] 2xl:w-[750px] border-t border-[#636363]",children:[e.jsxs(C,{to:"/posts/$postId",params:{postId:s.post.postId.toString()},children:[e.jsxs("div",{className:"relative my-1 rounded py-2 px-4 hover:bg-[#333333] transition-all ease-in-out duration-300",children:[e.jsxs("div",{className:"flex justify-between",children:[P?f?e.jsx("div",{children:"Loading..."}):p?e.jsx("div",{children:"Error loading community"}):n?e.jsxs("div",{className:"flex text-[#bdbdbd] text-sm",children:[e.jsx("img",{src:!f||p?n?n.icon?n.icon:i:i:i,alt:"",className:"w-6 h-6 rounded-full object-cover object-center"}),e.jsxs("div",{className:"font-bold ml-2",children:["c/",n.communityId]})]}):e.jsxs("div",{className:"flex text-[#bdbdbd] text-sm",children:[e.jsx("img",{src:!r||a?o?o.profilePic?o.profilePic:i:i:i,alt:"",className:"w-6 h-6 rounded-full object-cover object-center"}),r?e.jsx("div",{children:"Loading..."}):a?e.jsx("div",{children:"Unknown author"}):o?e.jsxs("div",{className:"font-bold ml-2",children:["u/",o.username]}):e.jsx("div",{children:"Unknown author"}),e.jsx("div",{className:"px-1",children:"•"}),e.jsx("div",{children:v(s.post.createdAt)})]}):e.jsxs("div",{className:"flex text-[#bdbdbd] text-sm",children:[e.jsx("img",{src:!r||a?o?o.profilePic?o.profilePic:i:i:i,alt:"",className:"w-6 h-6 rounded-full object-cover object-center"}),r?e.jsx("div",{children:"Loading..."}):a?e.jsx("div",{children:"Unknown author"}):o?e.jsxs("div",{className:"font-bold ml-2",children:["u/",o.username]}):e.jsx("div",{children:"Unknown author"}),e.jsx("div",{className:"px-1",children:"•"}),e.jsx("div",{children:v(s.post.createdAt)})]}),e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),u(!m)},className:"absolute top-1 right-1 p-3 rounded-full hover:bg-[#575757] transition-all ease-in-out duration-300",children:e.jsx(M,{})})]}),e.jsx("div",{className:"text-xl md:text-2xl font-semibold",children:s.post.title}),y?e.jsx("div",{children:"Loading..."}):N?e.jsx("div",{children:"Error loading images"}):j?j.map((t,E)=>{if(E<1)return e.jsx("div",{className:"w-full h-[220px] sm:h-[300px] md:h-[400px] xl:h-[500px] border border-[#424242] bg-[#202020] rounded-xl my-2 flex items-center justify-center",children:e.jsx("img",{src:`https://${t.imageUrl}`,alt:"",className:"w-full h-full object-contain"})},t.imageId)}):e.jsx("div",{children:"An unexpected error has occured"}),e.jsx("div",{className:"my-2",children:e.jsx("div",{className:"line-clamp-4",dangerouslySetInnerHTML:{__html:_.sanitize(s.post.content,{ALLOWED_TAGS:["b","i","u","s","strong","em","ul","ol","li","p","a"],ALLOWED_ATTR:["href","target","rel"],FORBID_ATTR:["style"]})}})}),e.jsxs("div",{className:"flex",children:[e.jsx(S,{post:s.post}),e.jsxs("div",{className:"flex bg-[#3e3e3e] w-fit rounded-full py-1 justify-center ml-2 hover:text-cyan-500 transition-all ease-in-out duration-300",children:[e.jsx("div",{className:"pl-3 pr-1",children:e.jsx(O,{size:20})}),e.jsx("div",{className:"pr-3 font-semibold",children:L?"Loading...":w?"Error loading comments":I??0})]})]}),m&&e.jsx(U,{post:s.post,setDeleteMode:c,setShowMenu:u})]}),d&&s.post.userId===d.userId&&x&&e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-[#222222] p-6 rounded shadow-lg w-[90%] max-w-md text-center z-100",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Delete Post?"}),e.jsx("div",{className:"my-5",children:"Once you delete this post, it can’t be restored."}),e.jsxs("div",{className:"my-5 flex justify-end",children:[e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),!h&&(b({postId:s.post.postId}),c(!1))},className:"p-2 mr-1 bg-red-500 rounded text-white bold secondary-font font-bold cursor-pointer",children:h?"Deleting...":"DELETE"}),e.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),c(!1)},className:"p-2 ml-1 bg-[#5c5c5c] rounded bold secondary-font font-bold cursor-pointer",children:"CANCEL"})]})]})]},s.post.postId),d&&s.post.userId===d.userId&&x&&e.jsx("div",{className:"fixed inset-0 bg-black opacity-50 z-90"})]})}export{G as P};
