import{U as i,V as u,S as c,T as o,W as y}from"./index-BAe1x1pE.js";const a=y();async function p(e){const r=await o.api.v0.users.$post({json:e});if(!r.ok){let n="There was an issue creating your account :( We'll look into it ASAP!";try{const t=await r.json();t&&typeof t=="object"&&"message"in t&&(n=String(t.message))}catch(t){console.error("Failed to parse error response:",t)}throw new Error(n)}const s=await r.json();if(!s.user)throw new Error("Invalid response from server");return s.user}const f=e=>{const r=i();return u({mutationFn:p,onSettled:()=>{r.invalidateQueries({queryKey:["users"]})},onError:s=>{}})};async function l(e){const r=await o.api.v0.users[":userId"].$get({param:{userId:e}});if(!r.ok)throw new Error("Error getting user by id");const{userQuery:s}=await r.json();return s}const m=e=>c({queryKey:["user",e],queryFn:()=>l(e)});async function w(e){const r=await o.api.v0.users.user[":username"].$get({param:{username:e}});if(!r.ok)throw new Error("Error getting user by id");const{userQuery:s}=await r.json();return s}const q=e=>c({queryKey:["user",e],queryFn:()=>w(e)});async function g(e){const r=await o.api.v0.users.update.profilepic.$post({json:e},a?{headers:{Authorization:`Bearer ${a}`}}:void 0);if(!r.ok)throw new Error("Error updating user.");const{newUser:s}=await r.json();return console.log(s),s}const v=()=>{const e=i();return u({mutationFn:g,onSettled:r=>{r&&(e.invalidateQueries({queryKey:["users",r.userId]}),e.invalidateQueries({queryKey:["users"]}))}})};export{v as a,q as b,m as g,f as u};
